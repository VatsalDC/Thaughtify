<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
        <meta name="theme-color" content="#f5f5f5">
        <meta name="description" content="Share your thoughts with the world on Thaughtify">
        <title>Thaughtify - Share Your Thoughts</title>
        <link rel="stylesheet" href="styles.css">
        <link rel="icon" type="image/x-icon" href="favicon.ico">
    </head>
    <body>
        <nav class="nav">
            <h1 id="title">Thaughtify</h1>
            <button class="nav-toggle" aria-label="Toggle navigation">
                <span class="hamburger"></span>
            </button>
        </nav>
        
        <main class="main-content">
            <div class="container">
            <section class="quote-section">
                <div class="quote-card">
                    <p class="quote-text">"Your thoughts shape your reality. Share them with the world on Thaughtify."</p>
                    <p class="quote-author">~Thaughtify</p>
                </div>
            </section>

            <div class="filter-container">
                <input type="text" id="search-thoughts" placeholder="Search thoughts...">
                <div class="custom-select">
                    <div class="selected-option">Newest First</div>
                    <div class="options-container">
                        <div class="option" data-value="date-desc">Newest First</div>
                        <div class="option" data-value="date-asc">Oldest First</div>
                        <div class="option" data-value="likes">Most Liked</div>
                    </div>
                    <select id="sort-thoughts" style="display: none;">
                        <option value="date-desc" selected>Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="likes">Most Liked</option>
                    </select>
                </div>
            </div>

            <div class="thoughts-container" id="thoughts-container">
                <!-- Thoughts will be dynamically added here -->
            </div>
            </div>
        </main>

        <footer class="site-footer">
            <div class="container">
                <p>&copy; 2025 Thaughtify - Share Your Thoughts</p>
            </div>
        </footer>
        <script>
            // Make sure shared-thoughts.js is loaded first
            function loadScripts() {
                const scripts = [
                    'shared-thoughts.js',
                    'script.js'
                ];
                
                function loadScript(index) {
                    if (index >= scripts.length) {
                        // All scripts loaded, initialize the app
                        if (window.initializeApp) {
                            window.initializeApp();
                        }
                        return;
                    }
                    
                    const script = document.createElement('script');
                    script.src = scripts[index];
                    script.onload = () => loadScript(index + 1);
                    script.onerror = () => {
                        console.error('Failed to load script:', scripts[index]);
                        loadScript(index + 1); // Continue with next script even if one fails
                    };
                    document.body.appendChild(script);
                }
                
                loadScript(0);
            }
            
            // Start loading scripts when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadScripts);
            } else {
                loadScripts();
            }
            
            // Mobile navigation toggle
            document.addEventListener('DOMContentLoaded', function() {
                const navToggle = document.querySelector('.nav-toggle');
                const navMenu = document.querySelector('.nav-menu');
                const navOverlay = document.querySelector('.nav-overlay');

                if (navToggle) {
                    navToggle.addEventListener('click', function() {
                        const isExpanded = this.getAttribute('aria-expanded') === 'true';
                        this.setAttribute('aria-expanded', !isExpanded);
                        if (navMenu) navMenu.classList.toggle('active');
                        if (navOverlay) navOverlay.classList.toggle('active');
                        document.body.style.overflow = isExpanded ? '' : 'hidden';
                    });
                }

                // Close menu when clicking on overlay
                if (navOverlay) {
                    navOverlay.addEventListener('click', function() {
                        if (navToggle) navToggle.setAttribute('aria-expanded', 'false');
                        if (navMenu) navMenu.classList.remove('active');
                        this.classList.remove('active');
                        document.body.style.overflow = '';
                    });
                }
            });

        // Add to home screen prompt
        let deferredPrompt;
        const addBtn = document.createElement('button');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Show the install button
            addBtn.style.display = 'block';
            addBtn.textContent = 'Install Thaughtify App';
            addBtn.classList.add('install-btn');
            document.body.appendChild(addBtn);
            
            addBtn.addEventListener('click', () => {
                // Hide the install button
                addBtn.style.display = 'none';
                // Show the install prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });
    </script>
    <style>
        .install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }
        
        .install-btn:hover {
            background-color: #45a049;
        }
    </style>
</body>
</html>